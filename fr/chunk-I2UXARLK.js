import{a as l}from"./chunk-6IGA2WWS.js";import{E as s,I as d,_ as o,xb as a}from"./chunk-IDFEJ3YL.js";var c=class n{_repo=d(l);_entries=o([]);_loading=o(!1);_error=o(null);entries=this._entries.asReadonly();loading=this._loading.asReadonly();error=this._error.asReadonly();todayEntries=a(()=>{let e=new Date();return this._entries().filter(t=>{let r=new Date(t.timestamp);return r.getFullYear()===e.getFullYear()&&r.getMonth()===e.getMonth()&&r.getDate()===e.getDate();});});frequentFoods=a(()=>{let e=new Map();for(let t of this._entries())for(let r of t.foods)e.set(r.name,(e.get(r.name)??0)+1);return[...e.entries()].filter(([,t])=>t>=3).map(([t])=>t);});constructor(){this.loadAll();}async loadAll(){this._loading.set(!0),this._error.set(null);try{let e=await this._repo.findAll();this._entries.set(e);}catch(e){throw this._error.set("Erreur lors du chargement."),e;}finally{this._loading.set(!1);}}async add(e){let t=await this._repo.save(e);this._entries.update(r=>[...r,t]);}async update(e){let t=await this._repo.save(e);this._entries.update(r=>r.map(i=>i.id===t.id?t:i));}async remove(e){await this._repo.delete(e),this._entries.update(t=>t.filter(r=>r.id!==e));}static ɵfac=function(t){return new(t||n)();};static ɵprov=s({token:n,factory:n.ɵfac,providedIn:"root"});};export{c as a};/**i18n:918d96059ed66fbebb60f4bd87db3c1942466580e5a9c1fc52acfb8dfe04d50e*/